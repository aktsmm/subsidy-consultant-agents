```prompt
---
description: 補助金ナレッジベースを最新情報に更新するワークフロー
agent: subsidy-consultant
tools: ["fetch", "readFile", "replaceStringInFile", "runSubagent"]
---

# Prompt: ナレッジベース更新ワークフロー

補助金の公式サイトから最新情報を取得し、ナレッジベースを更新します。

## 前提条件

- 参照: [補助金ナレッジ概要](../instructions/subsidy/_overview.instructions.md)
- 対象: IT導入補助金、ものづくり補助金、省力化投資補助金、小規模事業者持続化補助金

## ワークフロー

このワークフローは **Prompt Chaining** パターンで実行します。

```

STEP 1: 情報収集（web-researcher）
↓ Gate: 新しい情報があるか？
STEP 2: 差分分析（現ナレッジとの比較）
↓ Gate: 更新が必要か？
STEP 3: 更新計画作成 → ユーザー承認
↓ Gate: 承認されたか？
STEP 4: ナレッジベース更新
↓
STEP 5: 更新ログ記録

```

## 指示

### STEP 1: 情報収集

`@web-researcher` に以下を委譲：

```

以下の補助金について最新情報を収集してください：

1. IT導入補助金（https://it-shien.smrj.go.jp/）
   - 公募要領の更新
   - スケジュール変更
   - 採択結果
   - お知らせ

2. ものづくり補助金（https://portal.monodukuri-hojo.jp/）
   - 公募要領の更新
   - 採択結果

3. 省力化投資補助金（https://shoryokuka.smrj.go.jp/）
   - カタログ製品の更新
   - 一般型の公募情報

4. 小規模事業者持続化補助金（https://r6.jizokukahojokin.info/）
   - 公募状況
   - 締切情報

各情報の取得日時とソースURLを明記してください。

````

### STEP 2: 差分分析

収集した情報と現在のナレッジベースを比較：

```markdown
## 差分レポート

### IT導入補助金
| 項目 | ナレッジベース | 公式サイト | 差分 |
|------|---------------|-----------|------|
| 1次締切 | ○月○日 | ○月○日 | なし/あり |
| 補助率 | ... | ... | ... |

### ものづくり補助金
...

### 更新が必要なファイル
- [ ] instructions/subsidy/it-hojo/schedule.instructions.md
- [ ] instructions/subsidy/other-subsidies/monodukuri.instructions.md
````

### STEP 3: 更新計画作成

```markdown
## 更新計画

**更新対象ファイル**:

1. [ファイル名] - [更新内容の概要]
2. ...

**更新内容詳細**:
[具体的な変更箇所と変更後の内容]

**リスク**:

- 公式情報が暫定版の可能性
- 次回公募で変更の可能性

---

この計画で更新を実行してよろしいですか？
```

### STEP 4: ナレッジベース更新

承認後、該当ファイルを更新：

1. 対象ファイルを読み込み
2. 該当箇所を特定
3. `replace_string_in_file` で更新
4. 「情報更新日」を本日に変更

### STEP 5: 更新ログ記録

```markdown
## 更新ログ

**更新日時**: YYYY-MM-DD HH:MM
**更新者**: Agent

### 更新内容

| ファイル | 更新箇所 | 変更前 | 変更後 |
| -------- | -------- | ------ | ------ |
| ...      | ...      | ...    | ...    |

### 情報ソース

- [URL1]
- [URL2]
```

## 出力フォーマット

```markdown
# ナレッジベース更新レポート

## 実行日時

YYYY-MM-DD HH:MM

## 収集結果サマリ

- IT導入補助金: [更新あり/なし]
- ものづくり補助金: [更新あり/なし]
- 省力化投資補助金: [更新あり/なし]
- 小規模事業者持続化補助金: [更新あり/なし]

## 更新したファイル

1. [ファイルパス] - [更新内容]

## 次回確認推奨日

[1週間後の日付]
```

## 使用例

**ユーザー**: 「ナレッジベースを最新情報に更新して」

**エージェント**:

1. 各公式サイトから情報収集
2. 差分を分析してレポート
3. 更新計画を提示して承認を求める
4. 承認後に更新実行
5. 更新ログを報告

---

## 検証方法

- [ ] 各公式サイトから情報が正しく取得されていること
- [ ] 差分分析が正確であること
- [ ] 更新後のファイルがMarkdownとして正しいこと
- [ ] 「情報更新日」が更新されていること

## カスタマイズのヒント

- 特定の補助金だけ更新したい場合: 「IT導入補助金のナレッジを更新して」
- 緊急更新: 「〇〇補助金の締切が変わったので更新して」
- 定期実行: 毎週月曜日に実行を推奨

```

```
