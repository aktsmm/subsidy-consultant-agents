```prompt
---
description: 顧客向け補助金資料をPowerPointで作成するワークフロー
agent: subsidy-consultant
tools: ["readFile", "runSubagent", "runInTerminal", "fetch"]
skill: powerpoint-automation
---

# Prompt: 顧客向けPPTX資料作成ワークフロー

顧客向けの補助金説明資料・提案資料をPowerPointで作成します。

## 前提条件

- スキル: powerpoint-automation（`.github/skills/powerpoint-automation/SKILL.md`）
- 参照: [補助金ナレッジ概要](../instructions/subsidy/_overview.instructions.md)
- 参照: [提案書テンプレート](../assets/templates/proposal-template.md)

## ワークフロー

このワークフローは **Orchestrator-Workers** パターンで実行します。

```

TRIAGE: 資料タイプを判定
↓
PLAN: スライド構成を計画 → ユーザー承認
↓
EXTRACT: ナレッジベースから情報抽出
↓
BUILD: content.json生成 → PPTX作成
↓
REVIEW: 品質チェック
↓
DONE: PowerPointを開く

```

## 資料タイプ

### Type A: 補助金概要説明資料

顧客に補助金制度を説明するための汎用資料。

```

スライド構成例（10枚）:

1. タイトル
2. 補助金とは
3. 対象者
4. 補助率・補助上限額
5. 申請枠の比較
6. 申請フロー
7. スケジュール
8. 必要書類
9. 注意事項
10. お問い合わせ

```

### Type B: 個別提案資料

特定顧客向けにカスタマイズした提案資料。

```

スライド構成例（8枚）:

1. タイトル
2. 御社の課題
3. 提案内容
4. 推奨補助金
5. 費用シミュレーション
6. スケジュール
7. 当社サポート内容
8. 次のステップ

```

### Type C: 補助金比較資料

複数の補助金を比較検討するための資料。

```

スライド構成例（6枚）:

1. タイトル
2. 補助金一覧
3. 補助率・上限額比較表
4. 対象経費の違い
5. 選定フローチャート
6. まとめ

````

## 指示

### 入力情報

```markdown
## 資料作成リクエスト

### 資料タイプ
- [ ] A: 補助金概要説明
- [ ] B: 個別提案
- [ ] C: 補助金比較

### 対象補助金
- [ ] IT導入補助金
- [ ] ものづくり補助金
- [ ] 省力化投資補助金
- [ ] 小規模事業者持続化補助金
- [ ] 全補助金比較

### 顧客情報（Type B の場合）
- 会社名:
- 業種:
- 導入したいもの:
- 予算:

### スライド枚数
- 希望枚数: （例: 10枚）

### 追加要望
-
````

### STEP 1: TRIAGE（資料タイプ判定）

入力からタイプを判定し、テンプレートを選択。

### STEP 2: PLAN（スライド構成計画）

```markdown
## スライド構成案

**資料タイプ**: [A/B/C]
**対象補助金**: [補助金名]
**スライド枚数**: [枚数]

| No  | タイプ  | タイトル   | 内容概要       |
| --- | ------- | ---------- | -------------- |
| 1   | title   | [タイトル] | [サブタイトル] |
| 2   | content | [見出し]   | [ポイント1-3]  |
| ... | ...     | ...        | ...            |

---

この構成でよろしいですか？
```

### STEP 3: EXTRACT（情報抽出）

ナレッジベースから該当情報を抽出：

- `@application-guide` → 申請フロー
- `@subsidy-selector` → 補助金比較
- ナレッジファイル → 詳細情報

### STEP 4: BUILD（PPTX作成）

1. content.json を生成
2. `create_from_template.py` でPPTX作成

```json
{
  "slides": [
    {
      "type": "title",
      "title": "IT導入補助金のご案内",
      "subtitle": "2026年度版"
    },
    {
      "type": "content",
      "title": "補助金とは",
      "items": [
        "中小企業のIT導入を支援する国の制度",
        "費用の1/2〜4/5が補助される",
        "最大450万円まで補助"
      ]
    }
  ]
}
```

### STEP 5: REVIEW（品質チェック）

```
チェック項目:
- [ ] テキストがスライドからはみ出していないか
- [ ] 数値・日付が最新か
- [ ] 誤字脱字がないか
- [ ] スライドの流れが論理的か
```

### STEP 6: DONE（完了）

PowerPointを開いて確認。

## 出力フォーマット

```markdown
# PPTX作成完了レポート

## 作成ファイル

- ファイル名: [ファイル名.pptx]
- パス: [フルパス]
- スライド枚数: [枚数]

## スライド一覧

| No  | タイトル |
| --- | -------- |
| 1   | ...      |
| 2   | ...      |

## 使用したナレッジ

- [ファイル1]
- [ファイル2]

## 注意事項

- [必要に応じて編集が必要な箇所]
```

## 使用例

### 例1: IT導入補助金の概要資料

**ユーザー**:

```
IT導入補助金の概要説明資料を10枚で作成してください。
```

**エージェント**:

1. Type A（概要説明）と判定
2. スライド構成を提案
3. 承認後、ナレッジから情報抽出
4. content.json生成 → PPTX作成
5. PowerPointを開く

### 例2: 個別顧客向け提案資料

**ユーザー**:

```
以下の顧客向けに提案資料を作成してください。

- 会社名: 株式会社サンプル
- 業種: 製造業
- 導入したいもの: 在庫管理システム
- 予算: 300万円
```

**エージェント**:

1. Type B（個別提案）と判定
2. eligibility-checker で対象確認
3. subsidy-selector で補助金選定
4. 提案内容をスライド化
5. PPTX作成

### 例3: 補助金比較資料

**ユーザー**:

```
IT導入補助金とものづくり補助金の比較資料を作ってください。
```

**エージェント**:

1. Type C（比較資料）と判定
2. 両補助金のナレッジを抽出
3. 比較表を作成
4. PPTX生成

---

## 検証方法

- [ ] content.json が正しいスキーマに従っていること
- [ ] PPTX が正常に生成されていること
- [ ] テキストがスライドに収まっていること
- [ ] 情報がナレッジベースと一致していること

## カスタマイズのヒント

- テンプレートを変更したい場合: `assets/base_template.pptx` を差し替え
- 会社ロゴを入れたい場合: テンプレートに事前設定
- 英語版を作成したい場合: Localizer Agent で翻訳

```

```
